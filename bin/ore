#!/usr/bin/env ruby

require_relative '../lib/ore'

INSTRUCTIONS = "Usage:\n\tbundle exec bin/ore run file.ore # Run once\n\tbundle exec bin/ore dev file.ore # Run with hot reload".freeze

if ARGV.empty?
	puts INSTRUCTIONS
	exit 1
end

begin
	case ARGV[0]
	when 'dev'
		if ARGV[1]
			puts Ore.interp_file_with_hot_reload ARGV[1]
		else
			puts "Error: No file specified.\n#{INSTRUCTIONS}"
			exit 1
		end
	when 'run'
		if ARGV[1]
			puts Ore.interp_file ARGV[1]
		else
			puts "Error: No file specified.\n#{INSTRUCTIONS}"
			exit 1
		end
	else
		puts "Unknown command: #{ARGV[0]}\n#{INSTRUCTIONS}"
		exit 1
	end
rescue Ore::Error => e
	$stderr.puts e.message
	exit 1
end
